service: scraper-serverless

frameworkVersion: '3'

plugins:
  - serverless-offline

provider:
  name: aws
  runtime: nodejs18.x
  region: us-east-1
  stage: ${opt:stage, 'dev'}
  timeout: 30 # 30 seconds timeout
  environment:
    NODE_ENV: ${opt:stage, 'dev'}
    # DB_HOST: ${env:DB_HOST}
    # DB_USER: ${env:DB_USER}
    # DB_PASSWORD: ${env:DB_PASSWORD}
    # DB_NAME: ${env:DB_NAME}

functions:
  hello:
    handler: src/handler.hello
    events:
      - http:
          path: hello
          method: get
          cors: true
  execute:
    handler: src/executeScript.execute
    events:
      - http:
          path: execute
          method: post
          cors: true
  status:
    handler: src/executeScript.status
    events:
      - http:
          path: execute/{executionId}
          method: get
          cors: true
          
  getTodayNews:
    handler: src/getTodayNews.handler
    events:
      - http:
          path: news/today
          method: get
          cors: true
          request:
            parameters:
              querystrings:
                category: false # Optional category filter
                page: false     # Optional page number (default: 1)
                limit: false    # Optional items per page (default: 10, max: 100)

  deleteNews:
    handler: src/deleteNews.handler
    events:
      - http:
          path: news/{newsId}
          method: delete
          cors: true
